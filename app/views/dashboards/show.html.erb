<div class="dashboard-wrapper">
    <div id="sidebar">
      <div class="sidebar-links">
        <ul>
          <!-- <a href="#" id="test"><li><i class="fa fa-user-o" aria-hidden="true"></i><p class="link-text">Profile</p></li></a> -->
          <a href="#"><li><i class="fa fa-user-o" aria-hidden="true"></i><p class="link-text">Mentor</p></li></a>
          <a href="#"><li><i class="fa fa-user-o" aria-hidden="true"></i><p class="link-text">Team</p></li></a>
          <a href="#" id="resources"><li><i class="fa fa-list-ul" aria-hidden="true"></i><p class="link-text"> Resources</p></li></a>

          <a href="#" id="test"><li><i class="fa fa-user-o" aria-hidden="true"></i><p class="link-text">TEST</p></li></a>
          <a href="#" id="link-3"><li><i class="fa fa-thumb-tack" aria-hidden="true"></i><p class="link-text"> Link 3</p></li></a>
        </ul>
      </div>
      <br>
      <!-- <div class="days-passed">
        Days passed: <%#= days_passed %>
      </div> -->
      <!-- <div class="question">
        <em><%#= eq_module1  %></em>
      </div> -->
    </div>





    <div id="main">

      <div class="row">

      <div class="move-it">
        <div class="lg-card" id="welcome-video">
          <i class="fa fa-times close" aria-hidden="true"></i>
          <div class="lg-card-content">

            <table class="ui single line table">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Email</th>
                  <th>Points</th>
                  <th colspan="3"></th>
                </tr>
              </thead>
              <tbody>
                <% @users.each do |user| %>
                  <tr>
                      <td>
                          <%= user.first_name %> <%= user.last_name %>
                      </td>
                      <td><%= user.email %></td>
                    <td><%= user.points %></td>
                  </tr>
                <% end %>
              </tbody>
            </table>

          </div>
        </div>
      </div>

      <% if current_user.sign_in_count == 1 %>

      <div class="move-it">
        <div class="lg-card" id="welcome-video">
          <i class="fa fa-times close" aria-hidden="true"></i>
          <div class="lg-card-content">

            <%= render 'welcome' %>

          </div>
        </div>
      </div>


      <% end %>


        <div class="row">
          <div class="col-xs-12 move-it col-md-6 col-md-offset-3">
            <div class="card">
              <i class="fa fa-times close" aria-hidden="true"></i>

              <div class="btn-group btn-group-vertical" data-toggle="buttons">
                <label class="btn active">
                  <input type="checkbox" name='personal-info' class="personal-info"><i class="fa fa-square-o fa-2x"></i><i class="fa fa-check-square-o fa-2x"></i><a href="http://www.northwestern.edu/hr/policies-forms/forms/personal-information/PersonalDataForm.pdf" target="_blank"><span class="strikethrough">Fill out your personal information</span></a>
                </label>
              </div>

              <!-- Item 2 -->
              <div class="btn-group btn-group-vertical" data-toggle="buttons">
                <label class="btn active">
                  <input type="checkbox" name='payroll-info' class="payroll-info"><i class="fa fa-square-o fa-2x"></i><i class="fa fa-check-square-o fa-2x"></i> <span class="strikethrough"><a href="https://rpservices.net/Pdf/DirectDepositPayrollADP.pdf" target="_blank" class="strikethrough">Fill the payroll information sheet</span></a>
                </label>
              </div>

            </div>
          </div>
        </div>



        <div class="row">
          <div class="col-xs-12 move-it col-md-6 col-md-offset-3">
            <div class="card">
            <i class="fa fa-times close" aria-hidden="true"></i>
              <h2>HR forms #2</h2>
              <input type="checkbox" id="box-AND-1"/>
              <input type="checkbox" id="box-AND-2"/>
              <input type="checkbox" id="box-AND-3"/>
              <label class="box" for="box-AND-1"></label>
              <label class="box" for="box-AND-2"></label>
              <label class="box" for="box-AND-3"></label>
              <div class="light light-AND">OK</div>
              <div class="doc-continue">Finish</div>
          </div>
        </div>


          <div class="col-xs-12 move-it col-md-6 col-md-offset-3">

            <div class="card">
              <i class="fa fa-times close" aria-hidden="true"></i>

              <h3>HR Docs</h3>

              <div class="checkbox">
                <label>
                  <h4>
                    <input type="checkbox" value="first_checkbox">
                    <a href="http://www.northwestern.edu/hr/policies-forms/forms/personal-information/PersonalDataForm.pdf" target="_blank" class="strikethrough">Fill the personal information sheet</a>
                  </h4>
                </label>
              </div>

              <div class="checkbox">
                <label>
                  <h4>
                    <input type="checkbox" value="first_checkbox">
                    <a href="https://rpservices.net/Pdf/DirectDepositPayrollADP.pdf" target="_blank" class="strikethrough">Fill the payroll information sheet</a>
                  </h4>
                </label>
              </div>
              <div class="checkbox">
                <label>
                  <h4>
                    <input type="checkbox" value="first_checkbox">
                    <a href="https://hr.wustl.edu/forms/Documents/UHC%20Claim%20Form.pdf" target="_blank" class="strikethrough">Fill the health insurance information sheet</a>
                  </h4>
                </label>
              </div>
            </div>

          </div>

          <% if @user.mentor %>
          <!-- <div class="row"> -->
            <div class="col-xs-12 move-it col-md-6 col-md-offset-3">
              <div class="card">
              <i class="fa fa-times close" aria-hidden="true"></i>
                <h3>Meet the mentor</h3>
                <div class="mentor">
                  <div class="mentor-photo">
                      <%= image_tag @user.mentor.photo, class: 'img-circle img-responsive' %>
                  </div>
                  <div class="mentor-text">
                    <h4>
                        <%= @user.mentor.first_name %> <%= @user.mentor.last_name %>
                    </h4>
                    <h5>
                        <%= @user.mentor.team.name %>
                    </h5>
                  </div>
                </div>
                <div class="btn btn-primary" href="#aboutModal" data-toggle="modal" data-target="#myModal">Click to more info</div>
              </div>
            </div>
          <!-- </div> -->
          <% end %>

          <% if @user.mentor %>
            <div class="col-xs-12 col-md-6 col-md-offset-3">
              <div id="myCarousel" class="carousel slide" style="margin: 0px auto;">
              <ol class="carousel-indicators hidden-xs hidden-sm" style="padding-bottom: 20px;">
                <li data-target="#carcousel-example-generic" data-slide-to="0" class="active"></li>
                <li data-target="#carcousel-example-generic" data-slide-to="1"></li>
                <li data-target="#carcousel-example-generic" data-slide-to="2"></li>
              </ol>
              <div class="carousel-inner">
                <% @user.team.users.each_with_index do |user, index| %>
                  <div class="item <%= "active" if index == 0 %>" align="center">
                    <div class="modal-dialog">
                      <div class="modal-content">
                        <div class="modal-header">
                          <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                          <h4 class="modal-title" id="myModalLabel"><%= user.team.name %> members</h4>
                          </div>
                        <div class="modal-body">
                          <center>
                            <img src="<%= @user.mentor.photo %>" name="aboutme" width="140" height="140" border="0" class="img-circle">
                            <h3 class="media-heading"><%= user.first_name %> <%= user.last_name %></h3>
                            <h4 class="media-heading"><%= user.position %></h4>
                          </center>
                          <hr>
                          <div>
                          <p class="text-left"><strong>Bio: </strong></p>
                            <%= user.bio %>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                <% end %>
              </div>
              <a class="left carousel-control" href="#myCarousel" data-slide="prev">‹</a>
              <a class="right carousel-control" href="#myCarousel" data-slide="next">›</a>
              </div>
            </div>
          <% end %>
      </div>
    </div>
</div>




<!-- Modal window for mentor -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
        <h4 class="modal-title" id="myModalLabel">More About <%= @user.mentor.first_name %></h4>
      </div>
      <div class="modal-body">
        <center>
        <img src="<%= @user.mentor.photo %>" name="aboutme" width="140" height="140" border="0" class="img-circle">
        <h3 class="media-heading"><%= @user.mentor.first_name %> <%= @user.mentor.last_name %><small> <%= @user.mentor.team.name %></small></h3>
        <span><strong>Skills: </strong></span>
            <span class="label label-warning">HTML5/CSS</span>
            <span class="label label-info">Adobe CS 5.5</span>
            <span class="label label-info">Microsoft Office</span>
            <span class="label label-success">Windows XP, Vista, 7</span>
        </center>
        <hr>
        <center>
        <p class="text-left"><strong>Bio: </strong><br>
            <%= @user.mentor.bio %></p>
        <br>
        </center>
      </div>
      <div class="modal-footer">
        <center>
        <button type="button" class="btn btn-default" data-dismiss="modal">I've heard enough about Joe</button>
        </center>
      </div>
    </div>
  </div>
</div>

</div>

<% content_for(:after_js) do %>
  <script>
    // console.log($('.progress-bar')[0].style.width);
    var current_user_points = <%= current_user.points %>;

    // $('.personal-info i').click(function() {
    //   if ($('.personal-info').prop("checked")) {
    //     var data = { user_id: <%= current_user.id %>, points: 5 };

    //     updatePoints();
    //     current_user_points += 5;
    //   }
    // })

    // $('.payroll-info i').click(function() {
    //   if ($('.payroll-info').prop("checked")) {
    //     var data = { user_id: <%= current_user.id %>, points: 5 };

    //     updatePoints();
    //     current_user_points += 5;
    //   }
    // })








// function updatePoints(data) {
//       $.ajax({
//         crossOrigin: true,
//         type: "POST",
//         data: data,
//         url: "<%= request.base_url %>/add_points",
//         success: function(response) {
//           console.log(response)
//         }
//       });
//     }








    var progressChecker = {

      init: function(userId, points) {
        current_user_id: userId;
        current_user_points: points;
        progressChecker.update();
      },

      // getters and setters
      getPoints: function() {
        return current_user_points;
      },

      addPoints: function(points) {
        current_user_points += points;
        progressChecker.update();

        return progressChecker.updatePoints(points);
      },

      resetPoints: function() {
        current_user_points = 0;
        progressChecker.update();

        $.ajax({
          crossOrigin: true,
          type: "POST",
          // data: {user_id: progressChecker.current_user_id },
          url: "<%= request.base_url %>/reset_points",
          success: function(response) {
            // Dimitri
            console.log(response)
          }
        });
      },

      update: function() {
        progressChecker.update_page_score();
        progressChecker.update_progress_bar();
      },

      updatePoints: function(points) {
        // experimental
        // console.log(arguments.callee.caller.name);

        $.ajax({
          crossOrigin: true,
          type: "POST",
          data: {user_id: progressChecker.current_user_id, points: points },
          url: "<%= request.base_url %>/add_points",
          success: function(response) {
            console.log(response)
          }
        });
      },

      update_page_score: function() {
        console.log("inside update: " + current_user_points);
        $(".user-points-updatable").text(current_user_points);
        $(".progress-bar").css({"width": current_user_points + "%"});
        $("#user-progress-bar").css({"width": current_user_points + "%"});
      },

      update_progress_bar: function() {
        console.log("inside update progress bar")
        console.log(current_user_points)
        // clear
        // Dimitri, why?
        if (progressChecker.getPoints() >= 24) {
          console.log('less than 24')
          $('.one').replaceWith('<div class="one no-color">');
          $('.two').replaceWith('<div class="two no-color">');
          $('.three').replaceWith('<div class="three no-color">');
          $('.first-star-done').replaceWith('<%= image_tag("icons/009-star.png", class: "first-star") %>');
        }

        // if ($('.progress-bar')[0].style.width >= '25%') {
        if (progressChecker.getPoints() >= 25) {
          $('.one').replaceWith('<div class="one success-color">');
          // $('.one').clone().insertBefore('.one').addClass('animated pulse').delay(200).removeClass('animated pulse');
        }
        // need to add default circle  again..
        if (progressChecker.getPoints() >= 50) {
          $('.two').replaceWith('<div class="two success-color">');
        }
        if (progressChecker.getPoints() >= 75) {
          $('.three').replaceWith('<div class="three success-color">');
        }
        if (progressChecker.getPoints() >= 100) {
          console.log('Greater than 99?')
          $('.first-star').replaceWith('<%= image_tag("icons/003-star-3.png", class: "first-star-done") %>');
          $('.first-star-done').addClass('animated rubberBand');
        }
      }

    };

    progressChecker.init(<%= current_user.id %>, <%= current_user.points %>);

    // after
    console.log("OUTSIDE")
    console.log(current_user_points)

    // modularise
    // TRIGGER
      $("#welcome-video").click(function(){
        setTimeout(function() {
          $.notify({
            // options
            icon: 'glyphicon glyphicon-warning-sign',
            title: 'Test your knowledge',
            message: 'How much do you know about our CEO?',
            url: 'https://github.com/mouse0270/bootstrap-notify',
            target: '_blank'
          },{
            // settings
            element: 'body',
            position: null,
            type: "info",
            allow_dismiss: true,
            newest_on_top: false,
            showProgressbar: false,
            placement: {
              from: "top",
              align: "right"
            },
            offset: 20,
            spacing: 10,
            z_index: 1031,
            delay: 5000,
            timer: 1000,
            url_target: '_blank',
            mouse_over: null,
            animate: {
              enter: 'animated fadeInDown',
              exit: 'animated fadeOutUp'
            },
            onShow: null,
            onShown: null,
            onClose: null,
            onClosed: null,
            icon_type: 'class',
            template: '<div data-notify="container" class="col-xs-11 col-sm-3 alert alert-{0}" role="alert">' +
              '<button type="button" aria-hidden="true" class="close" data-notify="dismiss">×</button>' +
              '<span data-notify="icon"></span> ' +
              '<span data-notify="title">{1}</span> ' +
              '<span data-notify="message">{2}</span>' +
              '<div class="progress" data-notify="progressbar">' +
                '<div class="progress-bar progress-bar-{0}" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div>' +
              '</div>' +
              '<a href="{3}" target="{4}" data-notify="url"></a>' +
            '</div>'
          });

          setTimeout(function() {
            $("#test").trigger('click');
          }, 4000);
        }, 5000);
      });

      // resoureces
      $('#resources').click(function(el) {
      var $content = $(
          "<div class='lg-card'>" +
            "<i class='fa fa-times close' aria-hidden='true'></i>" +
              "<div class='lg-card-content'>" +
                "<h1>Resources</h1>" +
              "</div>" +
            "</div>"
          ).hide().addClass('transReset');
      $("#main").prepend($content);
      $content.show(300, function() { $(this).removeClass('transReset') });

      $('.close').on( "click", function() {
        $(this).parent().slideUp(400);
      });
    });

    // Create lg card
    $('#link-3').click(function(el) {
      var $content = $("<div class='lg-card'>" +
            "<i class='fa fa-times close' aria-hidden='true'></i>" +
              "<div class='lg-card-content'>" +
                "<h1>Insert Video Here</h1>" +
              "</div>" +
          "</div>").hide().addClass('transReset');
      $("#main").prepend($content);
      $content.show(300, function() { $(this).removeClass('transReset') });

      $('.close').on( "click", function() {
        $(this).parent().slideUp(400);
      });
    });


    $('.close, .light-AND').on( "click", function() {
      $(this).parent().parent().slideUp(400);
    });

    // Points events
    // <%# if @user.points > 50 %>
    // // need to add default value on points for users
    //   $.notify({
    //     // options
    //     message: 'Congrats on joining'
    //   },{
    //     // settings
    //     type: 'danger'
    //   });
    // <%# end %>

    $("#test").click(function(el) {
      swal.setDefaults({
        input: 'text',
        confirmButtonText: 'Next &rarr;',
        showCancelButton: true,
        animation: false,
        inputValidator: function (value) {
          return new Promise(function (resolve, reject) {
            if (value) {
              resolve()
            } else {
              reject('You need to write something!')
            }
          })
        },
        progressSteps: ['1', '2', '3']
      })

      // should be a hash? with correct answers?
      var steps = [
        {
          title: 'Question 1',
          text: 'What year was the company founded?'
        },
        {
          title: 'Question 2',
          text: 'What is our best selling product?'
        },
        {
          title: 'Question 3',
          text: 'How many employees do we have?'
        }
      ]

      swal.queue(steps).then(function (result) {
        swal.resetDefaults()
        // add ADV logic later
        var correct_answers = ['true', 'false', 'true'];
        console.log(result)

        swal({
          title: 'Well done!',
          html:
            'Have 10 points',
          confirmButtonText: 'Lovely!',
          showCancelButton: false
        })
      }, function () {
        swal.resetDefaults()
      }).then(function() {
        // Q for Dimitri: do i need to pass the id every time?
        var data = { user_id: <%= current_user.id %>, points: 10 };

        // progressChecker(data);
        progressChecker.updatePoints(data);

      });
    });


    // Add this to let the carousel start automatic
    // $('.carousel').carousel();
  </script>
<% end %>
